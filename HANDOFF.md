# Handoff: System Prompt V2 Integration

## ะกัะฐััั: V2 ะธะฝัะตะณัะธัะพะฒะฐะฝ ะฒ chat flow โ

SoloBuddy Hub ัะตะฟะตัั ะธัะฟะพะปัะทัะตั system-prompt-v2 (BIP Strategic Partner) ั ะดะธะฝะฐะผะธัะตัะบะธะผ ะบะพะฝัะตะบััะพะผ.

---

## ะะพัะปะตะดะฝัั ัะตััะธั: V2 Integration (2026-01-13)

### ะงัะพ ัะดะตะปะฐะฝะพ

**ะััะธัะตะบัััะฐ ะฟัะพะผะฟัะฐ:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 1. Language enforcement (RU/EN)             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ 2. system-prompt-v2.md                      โ
โ    - BIP Strategic Partner identity         โ
โ    - <user_context> ะธะท onboarding wizard    โ
โ    - Shotgun-to-Sniper ัะธะปะพัะพัะธั            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ 3. Runtime context (buildRuntimeContextSection) โ
โ    - Git activity patterns                  โ
โ    - Projects list                          โ
โ    - Backlog ideas                          โ
โ    - Drafts in progress                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะะทะผะตะฝัะฝะฝัะต ัะฐะนะปั:**
- [x] `hub/prompt-builder.js` โ ะดะพะฑะฐะฒะปะตะฝ `buildRuntimeContextSection()`, ะผะพะดะธัะธัะธัะพะฒะฐะฝ `buildSystemPromptV2(context, options)`
- [x] `hub/chat-api.js` โ `sendToClaude()` ะธัะฟะพะปัะทัะตั V2 ะฒะผะตััะพ V1
- [x] `hub/intent-parser.js` โ ัะฑัะฐะฝ "ัะพะฒะตั" ะธะท ััะธะณะณะตัะพะฒ content generation
- [x] `hub/groq-classifier.js` โ ะดะพะฑะฐะฒะปะตะฝะพ ะธัะบะปััะตะฝะธะต ะดะปั advice/strategy ะทะฐะฟัะพัะพะฒ

**Fix: Intent Detection**
- "ัะพะฒะตั ะฟะพ ัััะฐัะตะณะธะธ" ะฑะพะปััะต ะฝะต ะพัะบััะฒะฐะตั ะบะฐััะพัะบั ะณะตะฝะตัะฐัะธะธ ะบะพะฝัะตะฝัะฐ
- ะัะฟัะฐะฒะปะตะฝะพ ะฒ regex patterns ะธ ะฒ Groq Gate classifier

### ะะพะผะผะธั
```
8e91de9 feat(chat): integrate system-prompt-v2 with runtime context
```

---

## ะะทะฒะตััะฝัะต ะฟัะพะฑะปะตะผั

### Issue #3: Hub ะฝะต ะฟะพะฝะธะผะฐะตั ะฒัะตะผะตะฝะฝะพะน ะบะพะฝัะตะบัั
https://github.com/Humanji7/solobuddy/issues/3

**ะัะพะฑะปะตะผะฐ:** Buddy ะฟัะตะดะปะฐะณะฐะตั "ะฟัะพะฒะตััะน feedback ะพั ะฐัะดะธัะพัะธะธ" ัะพัั ะฟะพะปัะทะพะฒะฐัะตะปั ัะพะปัะบะพ ะฒัะตัะฐ ะฒัะปะพะถะธะป ะฟะตัะฒัะน ะฟะพัั.

**ะะตัะตะฝะธะต:** ะะพะฑะฐะฒะธัั ะฒ user-context:
- `bipStartDate` โ ะบะพะณะดะฐ ะฝะฐัะฐะป BIP
- `postsCount` โ ัะบะพะปัะบะพ ะฟะพััะพะฒ ะพะฟัะฑะปะธะบะพะฒะฐะฝะพ
- ะะฝัะตะณัะฐัะธั ั `my-posts.json`

---

## ะงัะพ ะดะฐะปััะต: ะัะธะพัะธัะตัั

### ๐ด ะัะธัะธัะฝะพ (ะฒะปะธัะตั ะฝะฐ ะบะฐัะตััะฒะพ ัะพะฒะตัะพะฒ)

1. **ะัะตะผะตะฝะฝะพะน ะบะพะฝัะตะบัั** (Issue #3)
   - Hub ะดะพะปะถะตะฝ ะทะฝะฐัั: "ะฟะตัะฒะฐั ะฝะตะดะตะปั" vs "3 ะผะตัััะฐ ะฟะพััะธะฝะณะฐ"
   - ะะปะธัะตั ะฝะฐ ะฒัะต ัััะฐัะตะณะธัะตัะบะธะต ัะพะฒะตัั

2. **Per-project phase tracking**
   - ะกะตะนัะฐั ะพะดะฝะฐ ัะฐะทะฐ ะฝะฐ ะฒัั (shotgun/sniper)
   - ะัะถะฝะพ: SPHERE ะผะพะถะตั ะฑััั ะฒ sniper, VOP ะฒ shotgun

### ๐ก ะะฐะถะฝะพ (ัะปัััะตะฝะธะต UX)

3. **ะะฝัะตะณัะฐัะธั my-posts.json ะฒ ะบะพะฝัะตะบัั**
   - Buddy ะดะพะปะถะตะฝ ะฒะธะดะตัั ััะพ ัะถะต ะพะฟัะฑะปะธะบะพะฒะฐะฝะพ
   - ะะพะถะตั ะฟัะตะดะปะฐะณะฐัั follow-up ะฟะพััั

4. **Style Learning**
   - ะะฑััะตะฝะธะต ััะธะปั ะฟะพ ัะธะฝะฐะปัะฝัะผ (ะพะฟัะฑะปะธะบะพะฒะฐะฝะฝัะผ) ะฟะพััะฐะผ
   - ะะต ะฟะพ ัะตัะฝะพะฒะธะบะฐะผ, ะฐ ะฟะพ ัะตะฐะปัะฝะพะผั ะบะพะฝัะตะฝัั

### ๐ข Nice to have

5. **Language Toggle** โ ัััะฝะพะน ะฟะตัะตะบะปััะฐัะตะปั EN/RU
6. **Editor Mode** โ ัะตะดะฐะบัะธัะพะฒะฐะฝะธะต ัััะตััะฒัััะตะณะพ ะบะพะฝัะตะฝัะฐ
7. **SOUL Protocol v2** โ ัะปัััะตะฝะฝัะต project voices

---

## ะขะตะบััะตะต ัะพััะพัะฝะธะต ัะธััะตะผั

| ะะพะผะฟะพะฝะตะฝั | ะกัะฐััั | ะัะธะผะตัะฐะฝะธะต |
|-----------|--------|------------|
| Chat API | โ V2 | ะัะฟะพะปัะทัะตั system-prompt-v2 + runtime context |
| Content Generation | โ V1 | ะัะฟะพะปัะทัะตั buildContentPrompt (ััะฐัะฐั ะฒะตััะธั) |
| User Onboarding | โ | Wizard ัะฐะฑะพัะฐะตั, ะดะฐะฝะฝัะต ะฒ user-context.json |
| Project Voice | โ | SOUL personality extraction ัะฐะฑะพัะฐะตั |
| Intent Detection | โ Fixed | "ัะพะฒะตั" ะฑะพะปััะต ะฝะต ััะธะณะณะตัะธั content card |
| Groq Gate | โ Fixed | ะัะบะปััะฐะตั advice/strategy ะทะฐะฟัะพัั |

---

## ะะตะบะพะผะตะฝะดัะตะผัะน ัะปะตะดัััะธะน ัะฐะณ

**ะะฐัะฝะธ ั Issue #3 (ะฒัะตะผะตะฝะฝะพะน ะบะพะฝัะตะบัั)** โ ััะพ ััะฝะดะฐะผะตะฝั ะดะปั ะฟัะฐะฒะธะปัะฝัั ัะพะฒะตัะพะฒ.

```
1. ะะพะฑะฐะฒะธัั ะฟะพะปั ะฒ user-context.json:
   - bipStartDate
   - postsCount (ะธะปะธ ะฐะฒัะพะผะฐัะธัะตัะบะธ ะธะท my-posts.json)

2. ะะฑะฝะพะฒะธัั buildUserContextSection() ะฒ prompt-builder.js

3. ะะฑะฝะพะฒะธัั system-prompt-v2.md โ ะดะพะฑะฐะฒะธัั ัะตะบัะธั ะฟัะพ ััะฐะดะธั BIP
```

---

## ะะฐะบ ะทะฐะฟัััะธัั

```bash
cd hub && npm start
# http://localhost:3000
```

---

**ะะตะฟะพะทะธัะพัะธะน:** https://github.com/Humanji7/solobuddy
